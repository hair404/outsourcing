<!DOCTYPE html>
<meta charset="utf-8">
<html>

<head>
    <title>人力和项目服务平台</title>
    <link rel="icon" type="image/x-icon" href="./img/logo.ico" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <link href="./css/material-design-icons.css" rel="stylesheet">
    <link type="text/css" rel="styleSheet" href="./css/main.css" />
</head>

<body style="background-color: rgb(246, 246, 246);">
    <div id="notify" class="card notify" style="display: none;"></div>
    <div class="top">
        <div class="head">
            <div class="blur"></div>
            <div class="cover"></div>
            <div class="wrapper">
                <img>
                <div class="nav">
                    <ul>
                        <li><a href="./index.html">首页</a></li>
                        <li><a href="./search.html?type=0">全部招标</a></li>
                        <li><a href="./search.html?type=1">全部工作室</a></li>
                    </ul>
                </div>
                <div style="float: right;height: 42px;padding-right: 10px;">
                    <div class="account" onmouseover="display(0);" id="person">
                        <div>游客</div>
                        <img id="personalPic">
                    </div>
                    <div class="card info" onmouseleave="display(1)">
                        <div class="card" style="height: 84px;" id="info">
                            <div style="line-height: 42px;text-align: center;">您是：游客</div>
                            <div style="line-height: 42px;text-align: center;"></div>
                        </div>
                        <ul id="option" class="selection" style="width: 100%;list-style: none;">
                            <li style="line-height: 42px;text-align: center;"><a>我的项目</a></li>
                            <li style="line-height: 42px;text-align: center;"><a>我的收藏</a></li>
                            <li style="line-height: 42px;text-align: center;"><a>登录</a></li>
                        </ul>
                    </div>
                </div>
                <div class="message">消息</div>
            </div>
        </div>
        <div class="background">
            <div class="logo"><img src="./img/logo2.png"></div>
            <form id="search" class="_search">
                <input type="text" placeholder="你想搜索">
                <button type="submit" style="background: transparent;border: transparent;"><i class="material-icons search" style="line-height: 30px;color: #00a1d6;cursor: pointer;"></i></button>
            </form>
        </div>
    </div>
    <div class="wrapper" style="height: 42px;">
        <div class="categories nav">
            <ul id="ctg">
                <li><a>首页</a></li>
                <li><a>网站开发</a>
                    <ul class="selection card" style="width: 100px;position: absolute;">
                        <li><a>前端开发</a></li>
                        <li><a>网站维护</a></li>
                    </ul>
                </li>
                <li><a>移动应用开发</a>
                    <ul class="selection card" style="width: 100px;position: absolute;">
                        <li><a>安卓APP</a></li>
                        <li><a>苹果APP</a></li>
                    </ul>
                </li>
                <li><a>H5开发</a>
                    <ul class="selection card" style="width: 100px;position: absolute;">
                        <li><a>H5模板</a></li>
                        <li><a>H5定制</a></li>
                    </ul>
                </li>
                <li><a>UI设计</a>
                    <ul class="selection card" style="width: 100px;position: absolute;">
                        <li><a>网站UI</a></li>
                        <li><a>移动UI</a></li>
                    </ul>
                </li>
                <li><a>测试运维</a></li>
                <li><a>云服务</a></li>
                <li><a>IT综合服务</a></li>
            </ul>
        </div>
    </div>
    <div class="wrapper" style="display: flex;flex-wrap: wrap;">
        <div name="project" class="card left-recommend" style="cursor: pointer;">
            <div style="width: 100%;height: 80%;overflow: hidden;border-top-left-radius: 3px;border-top-right-radius: 3px;">
                <img class="autoimg">
            </div>
            <div style="height: 20%;">
                <div class="pro-name"></div>
                <div class="pro-price" style="line-height: 70px;"></div>
            </div>
        </div>
        <div class="right-recommend">
            <div style="display: flex;flex-wrap: wrap">
                <div name="project" class="card right-cell" style="margin-left: 0;margin-top: 0;cursor: pointer;">
                    <div class="pic">
                        <img class="autoimg">
                    </div>
                    <div style="height: 20%;text-align: center;">
                        <div class="pro-name"></div>
                        <div class="pro-price"></div>
                    </div>
                </div>
                <div name="project" class="card right-cell" style="margin-right: 0;margin-top: 0;cursor: pointer;">
                    <div class="pic">
                        <img class="autoimg">
                    </div>
                    <div style="height: 20%;text-align: center;">
                        <div class="pro-name"></div>
                        <div class="pro-price"></div>
                    </div>
                </div>
                <div name="project" class="card right-cell" style="margin-left: 0;margin-bottom: 0;cursor: pointer;">
                    <div class="pic">
                        <img class="autoimg">
                    </div>
                    <div style="height: 20%;text-align: center;">
                        <div class="pro-name"></div>
                        <div class="pro-price"></div>
                    </div>
                </div>
                <div name="project" class="card right-cell" style="margin-right: 0;margin-bottom: 0;cursor: pointer;">
                    <div class="pic">
                        <img class="autoimg">
                    </div>
                    <div style="height: 20%;text-align: center;">
                        <div class="pro-name"></div>
                        <div class="pro-price"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper">
        <div class="container" id="container">
        </div>
    </div>
</body>

<!-- firebase -->
<script src="./js/firebase/firebase-app.js"></script>
<script src="./js/firebase/firebase-messaging.js"></script>
<script src="./js/firebase/firebase.js"></script>

<script src="./js/utils.js"></script>
<script src="./js/main.js"></script>
<script>
    var myid;
    var mytype;

    sync_info($("person"), $("info"), $("option"), function () {
        if (myid != null)
            navigator.serviceWorker.register('./js/firebase/sw.js').then((registration) => {
                firebase.messaging().useServiceWorker(registration);
                Notification.requestPermission().then((permission) => {
                    if (permission === 'granted') {
                        console.log('Notification permission granted.');
                        messaging.getToken().then((currentToken) => {
                            if (currentToken) {
                                console.log(currentToken);
                                initFirebase();
                                sendAjax("post", "token", "token=" + currentToken, (response) => { if (response != "success") notify("通知服务注册失败"); });
                            } else {
                                console.log('No Instance ID token available. Request permission to generate one.');
                            }
                        }).catch((err) => {
                            console.log('An error occurred while retrieving token. ', err);
                        });

                    } else {
                        console.log('Unable to get permission to notify.');
                    }
                });
            });
    });
    sendAjax("post", "recommend", "first=1&end=" + length, todo);
    window.addEventListener("scroll", function () {
        if ((document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop) + window.innerHeight >= (document.body.scrollHeight - 100)) {
            load(sizeofRow * 4);
        }
    });
</script>

</html>